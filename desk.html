<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows æ¡Œé¢ - é’å·å…¬å®‰å±€è°ƒæŸ¥ç³»ç»Ÿ</title>
    <style>
        :root {
            --windows-blue: #0078d7;
            --wechat-green: #07c160;
            --monitor-red: #e53935;
            --evidence-blue: #4285f4;
            --note-yellow: #ffeb3b;
            --desktop-icon-color: #fff;
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: "Microsoft YaHei", "Segoe UI", sans-serif; 
        }

        body {
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            /* æ›´æ¢ä¸ºäº®è‰²æ¸å˜èƒŒæ™¯ */
            background: 
                linear-gradient(rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.6)),
                linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #ff9a9e 100%);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            display: block;
            user-select: none;
            position: relative;
        }

        /* æ·»åŠ å£çº¸æ–‡å­— */
        body::before {
            content: "ä¿ä½‘é¡ºåˆ©ä¸‹ç­ åƒä¸‡åˆ«æœ‰æ¡ˆå­";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 36px;
            font-weight: 300;
            color: rgba(0, 0, 0, 0.15);
            text-align: center;
            z-index: 0;
            pointer-events: none;
            letter-spacing: 2px;
            line-height: 1.4;
            max-width: 80%;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- Windows ä»»åŠ¡æ  (åº•éƒ¨) --- */
        .windows-taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 48px;
            background: rgba(32, 32, 32, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            padding: 0 12px;
            z-index: 999;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .start-button {
            width: 44px;
            height: 44px;
            background: linear-gradient(to bottom, #5aa2e8, #0078d7);
            border-radius: 6px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            font-size: 22px;
            margin-right: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .start-button:hover {
            background: linear-gradient(to bottom, #6ab2f8, #1088e7);
            transform: scale(1.05);
        }

        .taskbar-apps {
            display: flex;
            gap: 8px;
            flex: 1;
        }

        .taskbar-app {
            width: 44px;
            height: 44px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
            overflow: hidden;
        }

        .taskbar-app:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .taskbar-app.active {
            background: rgba(255, 255, 255, 0.25);
            border-bottom: 3px solid var(--windows-blue);
        }

        .taskbar-icon {
            width: 32px;
            height: 32px;
            object-fit: contain;
            border-radius: 4px;
        }

        .system-tray {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            font-size: 13px;
            padding-right: 15px;
        }

        .taskbar-time {
            font-size: 14px;
            font-weight: 500;
            min-width: 120px;
            text-align: right;
        }

        /* --- æ¡Œé¢å›¾æ ‡åŒºåŸŸ --- */
        .desktop-icons {
            position: absolute;
            top: 30px;
            left: 30px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            z-index: 100;
        }

        .desktop-icon {
            width: 90px;
            height: 110px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            padding: 12px 5px;
            border-radius: 8px;
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .desktop-icon:active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(0.98);
        }

        .icon-image {
            width: 64px;
            height: 64px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
            overflow: hidden;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .icon-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* å¾®ä¿¡å›¾æ ‡æ”¹å›ç»¿åº•ç™½å­— */
        .wechat-icon {
            background: var(--wechat-green);
            color: white;
            font-size: 28px;
            font-weight: bold;
        }

        .icon-label {
            font-size: 12px;
            color: white;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.9);
            padding: 3px 6px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.5);
            max-width: 100%;
            word-break: break-word;
            line-height: 1.3;
        }

        /* --- è¿›åº¦æŒ‡ç¤ºå™¨ --- */
        .progress-indicator {
            position: fixed;
            bottom: 55px;
            left: 15px;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            padding: 8px 12px;
            border-radius: 8px;
            font-family: "Consolas", monospace;
            font-size: 0.9rem;
            z-index: 998;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* --- æ¡Œé¢æç¤º --- */
        .desktop-hint {
            position: fixed;
            top: 30px;
            right: 30px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
            z-index: 100;
            max-width: 200px;
            text-align: center;
        }

        /* ====== å¤‡å¿˜å½•çª—å£æ ·å¼ ====== */
        .notepad-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 700px;
            height: 500px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            z-index: 1000;
            resize: both;
            min-width: 400px;
            min-height: 300px;
            border: 1px solid #ccc;
        }

        .notepad-title-bar {
            height: 30px;
            background: linear-gradient(to bottom, #5aa2e8, #0078d7);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            color: white;
            cursor: move;
            user-select: none;
            border-bottom: 1px solid #0078d7;
        }

        .notepad-window-title {
            font-size: 14px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notepad-window-title::before {
            content: "ğŸ“";
            font-size: 16px;
        }

        .notepad-window-controls {
            display: flex;
            gap: 8px;
        }

        .notepad-window-btn {
            width: 28px;
            height: 28px;
            border: none;
            background: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .notepad-window-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .notepad-window-btn.close:hover {
            background-color: #e81123;
        }

        .notepad-menu-bar {
            height: 30px;
            background-color: #f0f0f0;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-size: 13px;
        }

        .notepad-menu-item {
            padding: 5px 12px;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
            position: relative;
        }

        .notepad-menu-item:hover {
            background-color: #e0e0e0;
        }

        .notepad-dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            border: 1px solid #ccc;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            min-width: 180px;
            z-index: 1001;
        }

        .notepad-menu-item:hover .notepad-dropdown-menu {
            display: block;
        }

        .notepad-dropdown-item {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 13px;
            border-bottom: 1px solid #f0f0f0;
        }

        .notepad-dropdown-item:hover {
            background-color: #0078d7;
            color: white;
        }

        .notepad-toolbar {
            height: 30px;
            background-color: #f8f8f8;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 10px;
            gap: 15px;
            font-size: 12px;
        }

        .notepad-tool-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notepad-tool-btn {
            padding: 4px 8px;
            border: 1px solid transparent;
            background: none;
            cursor: pointer;
            border-radius: 3px;
            font-size: 12px;
        }

        .notepad-tool-btn:hover {
            background-color: #e0e0e0;
            border-color: #ccc;
        }

        .notepad-editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .notepad-text-editor {
            flex: 1;
            padding: 15px;
            border: none;
            outline: none;
            resize: none;
            font-family: "Microsoft YaHei", "Segoe UI", Consolas, monospace;
            font-size: 14px;
            line-height: 1.6;
            color: #333;
            background-color: white;
            overflow-y: auto;
        }

        .notepad-text-editor::-webkit-scrollbar {
            width: 12px;
        }

        .notepad-text-editor::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .notepad-text-editor::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 6px;
        }

        .notepad-text-editor::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .notepad-status-bar {
            height: 25px;
            background-color: #f0f0f0;
            border-top: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-size: 12px;
            color: #666;
        }

        .notepad-status-item {
            margin-right: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .notepad-file-operations {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            padding: 20px;
            z-index: 1001;
            min-width: 300px;
        }

        .notepad-file-operations.active {
            display: block;
        }

        .notepad-file-input {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .notepad-file-btn {
            padding: 6px 12px;
            margin-right: 10px;
            background-color: #0078d7;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .notepad-file-btn:hover {
            background-color: #005a9e;
        }
    </style>
</head>
<body>

    <!-- æ¡Œé¢æç¤º -->
    <div class="desktop-hint">
        åŒå‡»å›¾æ ‡æ‰“å¼€åº”ç”¨<br>
        è°ƒæŸ¥çº¿ç´¢éšè—åœ¨æ–‡ä»¶ä¸­
    </div>

    <!-- æ¡Œé¢å›¾æ ‡ -->
    <div class="desktop-icons">
        <!-- å¾®ä¿¡å›¾æ ‡ - æ”¹å›ç»¿åº•ç™½å­— -->
        <div class="desktop-icon" onclick="openApp('wechat')">
            <div class="icon-image">
                ğŸ’¬
            </div>
            <div class="icon-label">å¾®ä¿¡</div>
        </div>

        <!-- è¯æ®æ£€ç´¢å›¾æ ‡ -->
        <div class="desktop-icon" onclick="openApp('evidence')">
            <div class="icon-image" >
                ğŸ”
            </div>
            <div class="icon-label">è¯æ®æ£€ç´¢</div>
        </div>

        <!-- å¤‡å¿˜å½•å›¾æ ‡ -->
        <div class="desktop-icon" onclick="openNotepad()">
            <div class="icon-image" style="background: color: #333; font-size: 28px; font-weight: bold;">
                ğŸ“
            </div>
            <div class="icon-label">å¤‡å¿˜å½•</div>
        </div>
    </div>

    <!-- Windows ä»»åŠ¡æ  -->
    <div class="windows-taskbar">
        <div class="start-button" onclick="openStartMenu()">
            ğŸªŸ
        </div>
        
        <div class="taskbar-apps">
            <!-- ä»»åŠ¡æ å¾®ä¿¡å›¾æ ‡ - ç»¿åº•ç™½å­— -->
            <div class="taskbar-app active" onclick="openApp('wechat')">
                <div class="taskbar-icon" style="background: color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px;">
                    ğŸ’¬
                </div>
            </div>
            
            <!-- ä»»åŠ¡æ è¯æ®æ£€ç´¢å›¾æ ‡ -->
            <div class="taskbar-app" onclick="openApp('evidence')">
                ğŸ”
            </div>
                        <!-- ä»»åŠ¡æ å¤‡å¿˜å½•å›¾æ ‡ -->
            <div class="taskbar-app" onclick="openNotepad()">
                <div class="taskbar-icon" style="background: color: #333; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 18px;">
                    ğŸ“
                </div>
            </div>
        </div>
        
        <div class="system-tray">
            <span>ğŸŒ</span>
            <span>ğŸ”Š</span>
            <div class="taskbar-time" id="taskbar-time-date">
                <!-- æ—¶é—´æ—¥æœŸä¼šé€šè¿‡JSåŠ¨æ€æ˜¾ç¤º -->
            </div>
        </div>
    </div>

    <!-- ====== å¤‡å¿˜å½•çª—å£ ====== -->
    <div class="notepad-window" id="notepadWindow" style="display: none;">
        <!-- æ ‡é¢˜æ  -->
        <div class="notepad-title-bar" id="notepadTitleBar">
            <div class="notepad-window-title">å¤‡å¿˜å½• - è®°äº‹æœ¬</div>
            <div class="notepad-window-controls">
                <button class="notepad-window-btn" onclick="minimizeNotepad()">â”€</button>
                <button class="notepad-window-btn" onclick="toggleMaximizeNotepad()">â–¡</button>
                <button class="notepad-window-btn close" onclick="closeNotepad()">Ã—</button>
            </div>
        </div>

        <!-- èœå•æ  -->
        <div class="notepad-menu-bar">
            <div class="notepad-menu-item">
                æ–‡ä»¶(F)
                <div class="notepad-dropdown-menu">
                    <div class="notepad-dropdown-item" onclick="newFile()">æ–°å»º(N)</div>
                    <div class="notepad-dropdown-item" onclick="openFile()">æ‰“å¼€(O)...</div>
                    <div class="notepad-dropdown-item" onclick="saveFile()">ä¿å­˜(S)</div>
                    <div class="notepad-dropdown-item" onclick="saveAs()">å¦å­˜ä¸º(A)...</div>
                    <div class="notepad-dropdown-item" onclick="closeNotepad()">é€€å‡º(X)</div>
                </div>
            </div>
            <div class="notepad-menu-item">
                ç¼–è¾‘(E)
                <div class="notepad-dropdown-menu">
                    <div class="notepad-dropdown-item" onclick="undo()">æ’¤é”€(U)</div>
                    <div class="notepad-dropdown-item" onclick="redo()">é‡åš(R)</div>
                    <div class="notepad-dropdown-item" onclick="cutText()">å‰ªåˆ‡(T)</div>
                    <div class="notepad-dropdown-item" onclick="copyText()">å¤åˆ¶(C)</div>
                    <div class="notepad-dropdown-item" onclick="pasteText()">ç²˜è´´(P)</div>
                    <div class="notepad-dropdown-item" onclick="deleteText()">åˆ é™¤(D)</div>
                    <div class="notepad-dropdown-item" onclick="selectAll()">å…¨é€‰(A)</div>
                </div>
            </div>
            <div class="notepad-menu-item">
                æ ¼å¼(O)
                <div class="notepad-dropdown-menu">
                    <div class="notepad-dropdown-item" onclick="toggleWordWrap()">è‡ªåŠ¨æ¢è¡Œ(W)</div>
                    <div class="notepad-dropdown-item" onclick="changeFontSize('increase')">å­—ä½“å¤§å°(S)</div>
                </div>
            </div>
            <div class="notepad-menu-item">
                æŸ¥çœ‹(V)
                <div class="notepad-dropdown-menu">
                    <div class="notepad-dropdown-item" onclick="toggleStatusBar()">çŠ¶æ€æ (S)</div>
                </div>
            </div>
            <div class="notepad-menu-item">
                å¸®åŠ©(H)
                <div class="notepad-dropdown-menu">
                    <div class="notepad-dropdown-item" onclick="showAbout()">å…³äºå¤‡å¿˜å½•(A)</div>
                </div>
            </div>
        </div>

        <!-- å·¥å…·æ  -->
        <div class="notepad-toolbar" id="notepadToolbar">
            <div class="notepad-tool-group">
                <button class="notepad-tool-btn" onclick="newFile()" title="æ–°å»º">ğŸ“„</button>
                <button class="notepad-tool-btn" onclick="saveFile()" title="ä¿å­˜">ğŸ’¾</button>
            </div>
            <div class="notepad-tool-group">
                <button class="notepad-tool-btn" onclick="undo()" title="æ’¤é”€">â†¶</button>
                <button class="notepad-tool-btn" onclick="redo()" title="é‡åš">â†·</button>
            </div>
            <div class="notepad-tool-group">
                <button class="notepad-tool-btn" onclick="cutText()" title="å‰ªåˆ‡">âœ‚ï¸</button>
                <button class="notepad-tool-btn" onclick="copyText()" title="å¤åˆ¶">ğŸ“‹</button>
                <button class="notepad-tool-btn" onclick="pasteText()" title="ç²˜è´´">ğŸ“</button>
            </div>
            <div class="notepad-tool-group">
                <button class="notepad-tool-btn" onclick="toggleWordWrap()" id="wordWrapBtn" title="è‡ªåŠ¨æ¢è¡Œ">â†µ</button>
            </div>
        </div>

        <!-- ç¼–è¾‘åŒºåŸŸ -->
        <div class="notepad-editor-container">
            <textarea 
                class="notepad-text-editor" 
                id="textEditor" 
                placeholder="åœ¨è¿™é‡Œè¾“å…¥æ‚¨çš„å¤‡å¿˜å½•å†…å®¹..."
                spellcheck="false"
            ># æ¡ˆä»¶å¤‡å¿˜å½• - æ»¨æ±Ÿæ–°åŸçƒ‚å°¾æ¥¼æ¡ˆ

## åŸºæœ¬ä¿¡æ¯
- æ¡ˆä»¶ç¼–å·ï¼šBJXC-20251111

------
æœ€åæ›´æ–°ï¼šä»Šå¤© 08:00</textarea>
        </div>

        <!-- çŠ¶æ€æ  -->
        <div class="notepad-status-bar" id="statusBar">
            <div class="notepad-status-item">è¡Œ 1, åˆ— 1</div>
            <div class="notepad-status-item">å­—ç¬¦æ•°: <span id="charCount">0</span></div>
            <div class="notepad-status-item">è¡Œæ•°: <span id="lineCount">0</span></div>
            <div class="notepad-status-item" id="wrapStatus">è‡ªåŠ¨æ¢è¡Œ: å¼€</div>
        </div>
    </div>

    <!-- æ–‡ä»¶æ“ä½œå¯¹è¯æ¡† -->
    <div class="notepad-file-operations" id="fileDialog">
        <h3 id="dialogTitle">ä¿å­˜æ–‡ä»¶</h3>
        <input type="text" class="notepad-file-input" id="fileName" placeholder="è¯·è¾“å…¥æ–‡ä»¶å">
        <div style="text-align: right; margin-top: 15px;">
            <button class="notepad-file-btn" onclick="confirmFileAction()">ç¡®å®š</button>
            <button class="notepad-file-btn" onclick="cancelFileAction()">å–æ¶ˆ</button>
        </div>
    </div>

    <script>
        // ====== æ¡Œé¢ç³»ç»ŸåŠŸèƒ½ ======
        // å®æ—¶æ›´æ–°ä»»åŠ¡æ æ—¶é—´ï¼ˆåŒ…å«å¹´æœˆæ—¥ï¼‰
        function updateTaskbarTime() {
            const now = new Date();
            
            // æ ¼å¼åŒ–æ—¥æœŸå’Œæ—¶é—´
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            const weekday = now.toLocaleDateString('zh-CN', { weekday: 'short' });
            
            const hour = now.getHours().toString().padStart(2, '0');
            const minute = now.getMinutes().toString().padStart(2, '0');
            
            // æ˜¾ç¤ºæ ¼å¼ï¼š2025å¹´12æœˆ29æ—¥ å‘¨ä¸€ 10:30
            const timeString = `${year}å¹´${month}æœˆ${day}æ—¥ ${weekday} ${hour}:${minute}`;
            
            document.getElementById('taskbar-time-date').textContent = timeString;
        }

        // åˆå§‹åŒ–æ—¶é—´å¹¶æ¯åˆ†é’Ÿæ›´æ–°
        updateTaskbarTime();
        setInterval(updateTaskbarTime, 60000);

        // åº”ç”¨äº¤äº’å‡½æ•°
        function openApp(appName) {
            const apps = document.querySelectorAll('.taskbar-app');
            apps.forEach(app => app.classList.remove('active'));
            
            event.currentTarget.classList.add('active');
            
            // æ‰“å¼€å¯¹åº”é¡µé¢
            const appPages = {
                'wechat': 'wechat.html',
                'monitor': 'monitor.html',
                'evidence': 'evidence.html'
            };
            
            if (appPages[appName]) {
                window.open(appPages[appName], '_blank');
            }
        }

        // å¼€å§‹èœå•å‡½æ•°
        function openStartMenu() {
            alert("å¼€å§‹èœå•å·²æ‰“å¼€ - è°ƒæŸ¥ç³»ç»Ÿå¯åŠ¨ä¸­...");
        }

        // ====== å¤‡å¿˜å½•åŠŸèƒ½ ======
        // è®°äº‹æœ¬çŠ¶æ€
        let notepadState = {
            isOpen: false,
            isMaximized: false,
            isMinimized: false,
            currentFile: 'æœªå‘½å.txt',
            isModified: false,
            wordWrap: true,
            showStatusBar: true,
            fontSize: 14
        };

        // æ‰“å¼€è®°äº‹æœ¬
        function openNotepad() {
            const notepadWindow = document.getElementById('notepadWindow');
            notepadWindow.style.display = 'flex';
            notepadState.isOpen = true;
            
            // æ›´æ–°å­—ç¬¦ç»Ÿè®¡
            updateCharacterCount();
            
            // èšç„¦åˆ°ç¼–è¾‘å™¨
            document.getElementById('textEditor').focus();
            
            // æ¿€æ´»ä»»åŠ¡æ å›¾æ ‡
            const apps = document.querySelectorAll('.taskbar-app');
            apps.forEach(app => app.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // å…³é—­è®°äº‹æœ¬
        function closeNotepad() {
            if (notepadState.isModified) {
                if (confirm('æ–‡æ¡£å·²ä¿®æ”¹ï¼Œæ˜¯å¦ä¿å­˜æ›´æ”¹ï¼Ÿ')) {
                    saveFile();
                }
            }
            document.getElementById('notepadWindow').style.display = 'none';
            notepadState.isOpen = false;
        }

        // æœ€å°åŒ–è®°äº‹æœ¬ï¼ˆæ¨¡æ‹Ÿï¼‰
        function minimizeNotepad() {
            const notepadWindow = document.getElementById('notepadWindow');
            notepadWindow.style.transform = 'translate(-50%, 100vh)';
            notepadState.isMinimized = true;
            
            setTimeout(() => {
                notepadWindow.style.display = 'none';
            }, 300);
        }

        // æœ€å¤§åŒ–/è¿˜åŸè®°äº‹æœ¬
        function toggleMaximizeNotepad() {
            const notepadWindow = document.getElementById('notepadWindow');
            const maximizeBtn = notepadWindow.querySelector('.notepad-window-controls .notepad-window-btn:nth-child(2)');
            
            if (notepadState.isMaximized) {
                // è¿˜åŸ
                notepadWindow.style.width = '700px';
                notepadWindow.style.height = '500px';
                notepadWindow.style.top = '50%';
                notepadWindow.style.left = '50%';
                notepadWindow.style.transform = 'translate(-50%, -50%)';
                maximizeBtn.textContent = 'â–¡';
            } else {
                // æœ€å¤§åŒ–
                notepadWindow.style.width = '90vw';
                notepadWindow.style.height = '80vh';
                notepadWindow.style.top = '50%';
                notepadWindow.style.left = '50%';
                notepadWindow.style.transform = 'translate(-50%, -50%)';
                maximizeBtn.textContent = 'â';
            }
            
            notepadState.isMaximized = !notepadState.isMaximized;
        }

        // æ‹–åŠ¨åŠŸèƒ½
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        let currentPos = { x: 0, y: 0 };

        document.getElementById('notepadTitleBar').addEventListener('mousedown', startDrag);

        function startDrag(e) {
            if (notepadState.isMaximized) return;
            
            isDragging = true;
            const notepadWindow = document.getElementById('notepadWindow');
            const rect = notepadWindow.getBoundingClientRect();
            
            dragOffset = {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
            
            currentPos = {
                x: rect.left,
                y: rect.top
            };
            
            document.addEventListener('mousemove', onDrag);
            document.addEventListener('mouseup', stopDrag);
        }

        function onDrag(e) {
            if (!isDragging) return;
            
            e.preventDefault();
            
            currentPos = {
                x: e.clientX - dragOffset.x,
                y: e.clientY - dragOffset.y
            };
            
            const notepadWindow = document.getElementById('notepadWindow');
            notepadWindow.style.left = currentPos.x + 'px';
            notepadWindow.style.top = currentPos.y + 'px';
            notepadWindow.style.transform = 'none';
        }

        function stopDrag() {
            isDragging = false;
            document.removeEventListener('mousemove', onDrag);
            document.removeEventListener('mouseup', stopDrag);
        }

        // æ–‡ä»¶æ“ä½œ
        function newFile() {
            if (notepadState.isModified) {
                if (confirm('æ–‡æ¡£å·²ä¿®æ”¹ï¼Œæ˜¯å¦ä¿å­˜å½“å‰å†…å®¹ï¼Ÿ')) {
                    saveFile();
                }
            }
            document.getElementById('textEditor').value = '';
            notepadState.currentFile = 'æœªå‘½å.txt';
            notepadState.isModified = false;
            updateWindowTitle();
            updateCharacterCount();
        }

        function saveFile() {
            if (notepadState.currentFile === 'æœªå‘½å.txt') {
                saveAs();
            } else {
                const content = document.getElementById('textEditor').value;
                localStorage.setItem(`notepad_${notepadState.currentFile}`, content);
                notepadState.isModified = false;
                updateWindowTitle();
                alert(`æ–‡ä»¶ "${notepadState.currentFile}" å·²ä¿å­˜ï¼`);
            }
        }

        function saveAs() {
            document.getElementById('dialogTitle').textContent = 'å¦å­˜ä¸º';
            document.getElementById('fileName').value = notepadState.currentFile;
            document.getElementById('fileDialog').classList.add('active');
            currentAction = 'saveAs';
        }

        // ç¼–è¾‘åŠŸèƒ½
        function undo() {
            document.getElementById('textEditor').focus();
            document.execCommand('undo');
            updateCharacterCount();
        }

        function redo() {
            document.getElementById('textEditor').focus();
            document.execCommand('redo');
            updateCharacterCount();
        }

        function cutText() {
            document.getElementById('textEditor').focus();
            document.execCommand('cut');
            updateCharacterCount();
        }

        function copyText() {
            document.getElementById('textEditor').focus();
            document.execCommand('copy');
        }

        function pasteText() {
            document.getElementById('textEditor').focus();
            document.execCommand('paste');
            updateCharacterCount();
        }

        function deleteText() {
            const editor = document.getElementById('textEditor');
            editor.focus();
            const start = editor.selectionStart;
            const end = editor.selectionEnd;
            const text = editor.value;
            
            if (start === end) {
                editor.value = text.substring(0, start) + text.substring(start + 1);
            } else {
                editor.value = text.substring(0, start) + text.substring(end);
            }
            
            editor.selectionStart = editor.selectionEnd = start;
            notepadState.isModified = true;
            updateWindowTitle();
            updateCharacterCount();
        }

        function selectAll() {
            document.getElementById('textEditor').focus();
            document.execCommand('selectAll');
        }

        // æ ¼å¼åŠŸèƒ½
        function toggleWordWrap() {
            notepadState.wordWrap = !notepadState.wordWrap;
            const editor = document.getElementById('textEditor');
            const wrapBtn = document.getElementById('wordWrapBtn');
            const wrapStatus = document.getElementById('wrapStatus');
            
            if (notepadState.wordWrap) {
                editor.style.whiteSpace = 'pre-wrap';
                wrapBtn.style.backgroundColor = '#e0e0e0';
                wrapStatus.textContent = 'è‡ªåŠ¨æ¢è¡Œ: å¼€';
            } else {
                editor.style.whiteSpace = 'nowrap';
                wrapBtn.style.backgroundColor = 'transparent';
                wrapStatus.textContent = 'è‡ªåŠ¨æ¢è¡Œ: å…³';
            }
        }

        function changeFontSize(action) {
            const editor = document.getElementById('textEditor');
            if (action === 'increase') {
                notepadState.fontSize = Math.min(24, notepadState.fontSize + 2);
            } else {
                notepadState.fontSize = Math.max(10, notepadState.fontSize - 2);
            }
            editor.style.fontSize = notepadState.fontSize + 'px';
        }

        // æŸ¥çœ‹åŠŸèƒ½
        function toggleStatusBar() {
            notepadState.showStatusBar = !notepadState.showStatusBar;
            const statusBar = document.getElementById('statusBar');
            statusBar.style.display = notepadState.showStatusBar ? 'flex' : 'none';
        }

        // å¸®åŠ©åŠŸèƒ½
        function showAbout() {
            alert('å¤‡å¿˜å½• - è®°äº‹æœ¬\nç‰ˆæœ¬ 1.0\n\nä¸€ä¸ªç®€å•çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå¯ç”¨äºè®°å½•æ¡ˆä»¶çº¿ç´¢å’Œå¤‡å¿˜å½•ã€‚\n\nÂ© 2025 æ˜å¾·ä¸­å­¦æ¡ˆä»¶è°ƒæŸ¥ç³»ç»Ÿ');
        }

        // æ›´æ–°çª—å£æ ‡é¢˜
        function updateWindowTitle() {
            const titleElement = document.querySelector('.notepad-window-title');
            const modified = notepadState.isModified ? '*' : '';
            titleElement.textContent = `ğŸ“ ${modified}${notepadState.currentFile} - å¤‡å¿˜å½•`;
        }

        // æ›´æ–°å­—ç¬¦ç»Ÿè®¡
        function updateCharacterCount() {
            const editor = document.getElementById('textEditor');
            const text = editor.value;
            const charCount = text.length;
            const lineCount = text.split('\n').length;
            
            document.getElementById('charCount').textContent = charCount;
            document.getElementById('lineCount').textContent = lineCount;
            
            // æ›´æ–°å…‰æ ‡ä½ç½®
            const cursorPos = editor.selectionStart;
            const textBeforeCursor = text.substring(0, cursorPos);
            const lines = textBeforeCursor.split('\n');
            const line = lines.length;
            const col = lines[lines.length - 1].length + 1;
            
            document.querySelector('.notepad-status-item:first-child').textContent = `è¡Œ ${line}, åˆ— ${col}`;
            
            // æ ‡è®°ä¸ºå·²ä¿®æ”¹
            notepadState.isModified = true;
            updateWindowTitle();
        }

        // æ–‡ä»¶å¯¹è¯æ¡†å¤„ç†
        let currentAction = '';
        
        function confirmFileAction() {
            const fileName = document.getElementById('fileName').value.trim();
            if (!fileName) {
                alert('è¯·è¾“å…¥æ–‡ä»¶åï¼');
                return;
            }
            
            if (currentAction === 'saveAs') {
                notepadState.currentFile = fileName.endsWith('.txt') ? fileName : fileName + '.txt';
                saveFile();
            }
            
            document.getElementById('fileDialog').classList.remove('active');
        }

        function cancelFileAction() {
            document.getElementById('fileDialog').classList.remove('active');
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ç›‘å¬ç¼–è¾‘å™¨å†…å®¹å˜åŒ–
            const editor = document.getElementById('textEditor');
            editor.addEventListener('input', updateCharacterCount);
            editor.addEventListener('keyup', updateCharacterCount);
            editor.addEventListener('click', updateCharacterCount);
            
            // åˆå§‹ç»Ÿè®¡
            updateCharacterCount();
            
            // å¯ç”¨è‡ªåŠ¨æ¢è¡Œ
            toggleWordWrap();
        });
    </script>
</body>
</html>